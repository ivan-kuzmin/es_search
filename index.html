<!DOCTYPE html>
<html >
<head>
    <meta charset="UTF-8">
    <link href="css/search.css" rel="stylesheet" media="all">
    <link href="css/table.css" rel="stylesheet" media="all">
    <script src="http://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="JSON-to-Table/JSON-to-Table.min.1.0.0.js"></script>
    <script src="elasticsearch-js/elasticsearch.min.js"></script>
    <script src="elasticsearch-js/elasticsearch.jquery.min.js"></script>
</head>
<body>
    <div class="input-wrapper" data-text="">
        <input id="search_input" type="text" placeholder="Searchâ€¦" autocomplete="off">
    </div>
    <p id="my" style="color: white;"></p>
    <div id="qr"></div>
    <script>
        var client = new $.es.Client({
            hosts: 'localhost:9200?filter_path=hits.hits._source'
        });

        var input = document.body.children[0];
        input.oninput = function() {
            if ($('input').val() != "")
                search($('input').val());
            else
                $('#my').text('')
        };

        function search(name) {
            name = "*"+name+"*"
            client.search({
                index: 'skoltech',
                type: 'professora',
                body: {
                    query: {
                        query_string: {
                            fields: ["firstname^3", "lastname^4", "position^2", "center"],
                            query: name
                        }
                    }
                }
            }).then(function (resp) {
                $('#my').createTable(resp.hits.hits.map(function(name, i) {
                    delete resp.hits.hits[i]._source.crei
                    return resp.hits.hits[i]._source;
                }));
            }, function (err) {
                console.trace(err.message);
            });
        }
        // $.post('https://qrcode-monkey.p.mashape.com/qr/custom', {
        //     "data":"https://www.qrcode-monkey.com",
        //     "config":{
        //         "body":"circle",
        //         "logo":"#facebook"
        //     },
        //     "size":300,
        //     "download":false,
        //     "file":"svg"
        // }, function(data) {
        //     $('#qr').text(data);
        // });
    </script>
    <script  src="js/search.js"></script>
</body>
</html>
